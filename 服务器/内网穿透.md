# 内网穿透

> 内网穿透，也即 NAT 穿透，进行 NAT 穿透是为了使具有某一个特定源 IP 地址和源端口号的数据包不被 **NAT 设备**屏蔽而**正确路由到内网主机**。

## 公网IP与内网IP

- **内网 IP ：** 内网 IP 是用户在使用局域网时，由局域网的网关所分配的 IP 地址，每一个内网 IP 实际上都可以映射到当前所在局域网网关的某一端口（ IPV4 地址通过 NAT 与端口映射方式实现，具体原理下文详解），拥有内网 IP 可以被同一局域网下的其他设备所访问到；

- **公网 IP ：** 内网的设备想要访问非同一局域网下的资源则必须通过公网 IP ，公网 IP 是没有经过 NAT 转换的由互联网供应商（ISP）提供的最原始的 IP 地址，每一个公网 IP 都可以直接在互联网中被直接定位到。



#### IPV4和 IPV6

> ipv6,普及程度不高,大部分网络用户依旧使用IPV4的IP地址,限制了公网IP个数;

- IPV4：PV4 由 32 位二进制数组成，一共有 2^32 个不同的 IPV4 地址

- IPV6： IPV6 由 128 位二进制数组成，理论上共有 2^128 个不同的 IPV6 地址

![IPV4和IPV6](img\IPV4和IPV6.png)

#### NAT(网络地址转换)技术

> 网络地址转化技术的核心作用在于实现对**公网 IP 地址的复用**，即所有的内网主机共用同一个 IP 地址;**解决公网IP不够的问题**

- 静态转换：将内网 IP 直接转换为公网 IP 地址，形成一一对应的方式

  ![静态转换](img\静态转换.png)

- 动态转换：将内网 IP 地址转换为公网 IP 地址，与静态转换不同的是动态转换会在 **IP 池**中选择空闲 IP 地址进行转换，即每次同一个内网 IP 对应的公网 IP 会发生改变

  ![动态转换](img\动态转换.png)

- **端口多路复用(PAT 技术)**：将内网 IP 与公网 IP 的某一端口进行映射，通过**公网 IP 的某一端口**访问公网

  > 最大程度上缓解 IPV4 地址紧张的现状,最为广泛使用的实现方式

  ![端口多路复用](img\端口多路复用.png)

总结: **端口多路复用(PAT)技术**可以最大程度上缓解 IPV4 地址紧张的现

## 内网穿透

方式:

花生壳、

ngrok、

frp